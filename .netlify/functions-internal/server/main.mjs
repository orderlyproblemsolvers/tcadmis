import e from"node:process";globalThis._importMeta_={url:import.meta.url,env:e.env};import{u as t,n as o,j as r,g as s}from"./chunks/_/nitro.mjs";import"@tidbcloud/serverless";import"node:crypto";import"node:http";import"node:https";import"node:events";import"node:buffer";import"@iconify/utils";import"consola";import"node:fs";import"node:path";const a=t(),handler=async e=>{const t=new URL(e.url),s=`${t.pathname}${t.search}`,n=await a.localCall({url:s,headers:e.headers,method:e.method,body:e.body}),i=function(e){const t=new Headers;for(const[s,a]of Object.entries(e))if("set-cookie"===s)for(const e of o(a))t.append("set-cookie",e);else void 0!==a&&t.set(s,r(a));return t}({...getCacheHeaders(t.pathname),...n.headers});return new Response(n.body,{status:n.status,headers:i})},n=31536e3;function getCacheHeaders(e){const{isr:t}=s(e);if(t){return{"Cache-Control":"public, max-age=0, must-revalidate","Netlify-CDN-Cache-Control":`public, max-age=${"number"==typeof t?t:n}, ${"number"==typeof t?`stale-while-revalidate=${n}`:"must-revalidate"}, durable`}}return{}}export{handler as default};
//# sourceMappingURL=main.mjs.map
