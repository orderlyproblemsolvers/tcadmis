import{createRenderer as e,getRequestDependencies as t,getPreloadLinks as r,getPrefetchLinks as n}from"vue-bundle-renderer/runtime";import{f as o,h as s,i as a,k as i,l as d,p as u,b as l,c,m as p,o as h,u as f}from"../_/nitro.mjs";import{renderToString as m}from"vue/server-renderer";import{createHead as y,propsToString as b,renderSSRHead as g}from"unhead/server";import{stringify as _,uneval as v}from"devalue";import{walkResolver as w}from"unhead/utils";import{toValue as x,isRef as C,hasInjectionContext as j,inject as S,ref as T,watchEffect as A,getCurrentInstance as R,onBeforeUnmount as k,onDeactivated as P,onActivated as H}from"vue";const VueResolver=(e,t)=>C(t)?x(t):t,$="usehead";function injectHead(){if(j()){const e=S($);if(!e)throw new Error("useHead() was called without provide context, ensure you call it through the setup() function.");return e}throw new Error("useHead() was called without provide context, ensure you call it through the setup() function.")}function useHead(e,t={}){const r=t.head||injectHead();return r.ssr?r.push(e||{},t):function(e,t,r={}){const n=T(!1);let o;A(()=>{const s=n.value?{}:w(t,VueResolver);o?o.patch(s):o=e.push(s,r)});R()&&(k(()=>{o.dispose()}),P(()=>{n.value=!0}),H(()=>{n.value=!1}));return o}(r,e,t)}function createHead(e={}){const t=y({...e,propResolvers:[VueResolver]});return t.install=function(e){return{install(t){t.config.globalProperties.$unhead=e,t.config.globalProperties.$head=e,t.provide($,e)}}.install}(t),t}const L={meta:[{name:"viewport",content:"width=device-width, initial-scale=1"},{charset:"utf-8"},{name:"theme-color",content:"#09033B"}],link:[],style:[],script:[],noscript:[],title:"The Covenant Academy MIS"},M={id:"teleports"},U={id:"__nuxt-loader"},z=`<div${b({id:"__nuxt",class:"isolate"})}>`,O="</div>",getPrecomputedDependencies=()=>import("../build/client.precomputed.mjs").then(e=>e.default||e).then(e=>"function"==typeof e?e():e),N=lazyCachedFunction(async()=>{const t=await import("../build/server.mjs").then(e=>e.default||e);if(!t)throw new Error("Server bundle is not available");const r=await getPrecomputedDependencies();return e(t,{precomputed:r,manifest:void 0,renderToString:async function(e,t){const r=await m(e,t);return z+r+O},buildAssetsURL:o})}),F=lazyCachedFunction(async()=>{const t=await getPrecomputedDependencies(),r=await import("../virtual/_virtual_spa-template.mjs").then(e=>e.template).catch(()=>"").then(e=>{{const t=`<div${b(U)}>`;return z+O+(e?t+e+"</div>":"")}}),n=e(()=>()=>{},{precomputed:t,manifest:void 0,renderToString:()=>r,buildAssetsURL:o}),a=await n.renderToString({});return{rendererContext:n.rendererContext,renderToString:e=>{const t=s(e.event);return e.modules||=new Set,e.payload.serverRendered=!1,e.config={public:t.public,app:t.app},Promise.resolve(a)}}});function lazyCachedFunction(e){let t=null;return()=>(null===t&&(t=e().catch(e=>{throw t=null,e})),t)}const E=lazyCachedFunction(()=>import("../build/styles.mjs").then(e=>e.default||e));function renderPayloadJsonScript(e){const t={type:"application/json",innerHTML:e.data?_(e.data,e.ssrContext._payloadReducers):"","data-nuxt-data":"nuxt-app","data-ssr":!e.ssrContext.noSSR,id:"__NUXT_DATA__"};e.src&&(t["data-src"]=e.src);return[t,{innerHTML:`window.__NUXT__={};window.__NUXT__.config=${v(e.ssrContext.config)}`}]}function splitPayload(e){const{data:t,prerenderedAt:r,...n}=e.payload;return{initial:{...n,prerenderedAt:r},payload:{data:t,prerenderedAt:r}}}const I={disableDefaults:!0};const D={omitLineBreaks:!0},X=[];globalThis.__buildAssetsURL=o,globalThis.__publicAssetsURL=u;const q=!!M.id,B=q?`<div${b(M)}>`:"",J=q?"</div>":"",W=/^[^?]*\/_payload.json(?:\?.*)?$/,Y=d(async e=>{const d=f(),u=e.path.startsWith("/__nuxt_error")?l(e):null;if(u&&!("__unenv__"in e.node.req))throw c({statusCode:404,statusMessage:"Page Not Found: /__nuxt_error"});const m=function(e){return{url:e.path,event:e,runtimeConfig:s(e),noSSR:e.context.nuxt?.noSSR||!1,head:createHead(I),error:!1,nuxt:void 0,payload:{},_payloadReducers:Object.create(null),modules:new Set}}(e),y={mode:"server"};if(m.head.push(L,y),u){if(u.statusCode&&=Number.parseInt(u.statusCode),"string"==typeof u.data)try{u.data=p(u.data)}catch{}!function(e,t){e.error=!0,e.payload={error:t},e.url=t.url}(m,u)}const b=W.test(m.url);if(b){const t=m.url.substring(0,m.url.lastIndexOf("/"))||"/";m.url=t,e._path=e.node.req.url=t}const v=h(e);!1===v.ssr&&(m.noSSR=!0);const w=await function(e){return e.noSSR?F():N()}(m);for(const e of X)m.modules.add(e);const x=await w.renderToString(m).catch(async e=>{if(m._renderResponse&&"skipping render"===e.message)return{};const t=!u&&m.payload?.error||e;throw await(m.nuxt?.hooks.callHook("app:error",t)),t}),C=m._renderResponse||b?[]:await async function(e){const t=await E(),r=new Set;for(const n of e)if(n in t&&t[n])for(const e of await t[n]())r.add(e);return Array.from(r).map(e=>({innerHTML:e}))}(m.modules??[]);if(await(m.nuxt?.hooks.callHook("app:rendered",{ssrContext:m,renderResult:x})),m._renderResponse)return m._renderResponse;if(m.payload?.error&&!u)throw m.payload.error;if(b){const e=function(e){return{body:_(splitPayload(e).payload,e._payloadReducers),statusCode:i(e.event),statusMessage:a(e.event),headers:{"content-type":"application/json;charset=utf-8","x-powered-by":"Nuxt"}}}(m);return e}const j=v.noScripts,{styles:S,scripts:T}=t(m,w.rendererContext);m._preloadManifest&&!j&&m.head.push({link:[{rel:"preload",as:"fetch",fetchpriority:"low",crossorigin:"anonymous",href:o(`builds/meta/${m.runtimeConfig.app.buildId}.json`)}]},{...y,tagPriority:"low"}),C.length&&m.head.push({style:C});const A=[];for(const e of Object.values(S))A.push({rel:"stylesheet",href:w.rendererContext.buildAssetsURL(e.file),crossorigin:""});if(A.length&&m.head.push({link:A},y),j||(m.head.push({link:r(m,w.rendererContext)},y),m.head.push({link:n(m,w.rendererContext)},y),m.head.push({script:renderPayloadJsonScript({ssrContext:m,data:m.payload})},{...y,tagPosition:"bodyClose",tagPriority:"high"})),!v.noScripts){const e="head";m.head.push({script:Object.values(T).map(t=>({type:t.module?"module":null,src:w.rendererContext.buildAssetsURL(t.file),defer:!t.module||null,tagPosition:e,crossorigin:""}))},y)}const{headTags:R,bodyTags:k,bodyTagsOpen:P,htmlAttrs:H,bodyAttrs:$}=await g(m.head,D),U={htmlAttrs:H?[H]:[],head:normalizeChunks([R]),bodyAttrs:$?[$]:[],bodyPrepend:normalizeChunks([P,m.teleports?.body]),body:[x.html,B+(q?joinTags([m.teleports?.[`#${M.id}`]]):"")+J],bodyAppend:[k]};return await d.hooks.callHook("render:html",U,{event:e}),{body:(z=U,`<!DOCTYPE html><html${joinAttrs(z.htmlAttrs)}><head>${joinTags(z.head)}</head><body${joinAttrs(z.bodyAttrs)}>${joinTags(z.bodyPrepend)}${joinTags(z.body)}${joinTags(z.bodyAppend)}</body></html>`),statusCode:i(e),statusMessage:a(e),headers:{"content-type":"text/html;charset=utf-8","x-powered-by":"Nuxt"}};var z});function normalizeChunks(e){const t=[];for(const r of e){const e=r?.trim();e&&t.push(e)}return t}function joinTags(e){return e.join("")}function joinAttrs(e){return 0===e.length?"":" "+e.join(" ")}const G=Object.freeze(Object.defineProperty({__proto__:null,default:Y},Symbol.toStringTag,{value:"Module"}));export{$ as h,G as r,useHead as u};
//# sourceMappingURL=renderer.mjs.map
