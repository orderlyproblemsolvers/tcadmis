import{_ as e}from"./Icon-nvTqRNH0.mjs";import{_ as t}from"./nuxt-link-Bg1T6Ek3.mjs";import{defineComponent as r,ref as l,withAsyncContext as o,computed as a,resolveComponent as i,mergeProps as s,unref as n,withCtx as d,createVNode as c,useSSRContext as u}from"vue";import{ssrRenderAttrs as p,ssrRenderComponent as f,ssrInterpolate as m,ssrRenderAttr as b,ssrRenderList as x,ssrIncludeBooleanAttr as v,ssrLooseContain as g,ssrLooseEqual as h}from"vue/server-renderer";import{u as y}from"./useToast-CQ7Y19Cm.mjs";import{u as w}from"./fetch-Cnghzd6E.mjs";import"./index-DgrTGmjN.mjs";import"@iconify/vue";import"@iconify/utils/lib/css/icon";import"./server.mjs";import"../_/nitro.mjs";import"@tidbcloud/serverless";import"node:crypto";import"node:http";import"node:https";import"node:events";import"node:buffer";import"@iconify/utils";import"consola";import"node:fs";import"node:path";import"pinia";import"vue-router";import"tailwindcss/colors";import"../routes/renderer.mjs";import"vue-bundle-renderer/runtime";import"unhead/server";import"devalue";import"unhead/utils";import"./asyncData-DWeUa_vf.mjs";import"reka-ui";import"@vueuse/core";import"@vue/shared";const $=r({__name:"index",__ssrInlineRender:!0,async setup(r){let u,$;const q=y(),A=l(""),B=l(!1),_=l(!1),k=l({}),{data:j,pending:S,refresh:E}=([u,$]=o(()=>w("/api/admin/teachers",{transform:e=>e||[]},"$pDUAHaxthr")),u=await u,$(),u),C=a(()=>{if(!A.value)return j.value;const e=A.value.toLowerCase();return j.value.filter(t=>t.full_name.toLowerCase().includes(e)||t.email.toLowerCase().includes(e))}),getActionItems=e=>[[{label:"Edit Profile",icon:"i-heroicons-pencil-square",click:()=>openEdit(e)}],[{label:"Delete Staff",icon:"i-heroicons-trash",class:"text-red-600",click:()=>deleteStaff(e)}]],deleteStaff=async e=>{if(confirm(`Are you sure you want to delete ${e.full_name}? This cannot be undone.`)){_.value=!0;try{await $fetch("/api/admin/staff-manage",{method:"POST",body:{action:"delete",id:e.id}}),q.add({title:"Staff Deleted",color:"green"}),B.value=!1,E()}catch(e){q.add({title:"Error",description:e.message,color:"red"})}finally{_.value=!1}}},openEdit=e=>{k.value={...e},B.value=!0};return(r,l,o,a)=>{const u=i("UNotifications"),y=e,w=t,$=i("UDropdown");l(`<div${p(s({class:"p-8 max-w-7xl mx-auto"},a))}>`),l(f(u,null,null,o)),l(`<div class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-6"><div><h1 class="text-3xl font-bold text-[#09033B]">Staff Directory</h1><p class="text-gray-500 mt-1">Manage ${m(n(C).length)} staff members.</p></div><div class="flex items-center gap-3 w-full sm:w-auto"><div class="relative flex-1 sm:w-64">`),l(f(y,{name:"i-heroicons-magnifying-glass",class:"w-5 h-5 absolute left-3 top-2.5 text-gray-400"},null,o)),l(`<input${b("value",n(A))} type="text" placeholder="Search name or email..." class="w-full pl-10 pr-4 py-2 rounded-lg border border-gray-300 focus:border-[#09033B] focus:ring-1 focus:ring-[#09033B] text-sm"></div>`),l(f(w,{to:"/admin/register",class:"bg-[#09033B] text-white px-4 py-2 rounded-lg shadow hover:bg-opacity-90 text-sm font-bold flex items-center gap-2 whitespace-nowrap transition-transform active:scale-95"},{default:d((e,t,r,l)=>{if(!t)return[c(y,{name:"i-heroicons-plus",class:"w-5 h-5"}),c("span",{class:"hidden sm:inline"},"Add Staff")];t(f(y,{name:"i-heroicons-plus",class:"w-5 h-5"},null,r,l)),t(`<span class="hidden sm:inline"${l}>Add Staff</span>`)}),_:1},o)),l("</div></div>"),n(S)?l('<div class="text-center py-20"><div class="animate-spin rounded-full h-10 w-10 border-b-2 border-[#09033B] mx-auto"></div></div>'):0===n(C).length?(l('<div class="text-center py-20 bg-white rounded-xl border border-dashed border-gray-300">'),l(f(y,{name:"i-heroicons-user-minus",class:"w-12 h-12 text-gray-400 mx-auto mb-2"},null,o)),l('<h3 class="text-lg font-medium text-gray-900">No staff found</h3></div>')):(l('<div class="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden"><div class="overflow-x-auto"><table class="min-w-full divide-y divide-gray-200"><thead class="bg-gray-50"><tr><th class="px-6 py-3 text-left text-xs font-bold text-gray-500 uppercase tracking-wider">Identity</th><th class="px-6 py-3 text-left text-xs font-bold text-gray-500 uppercase tracking-wider">Contact</th><th class="px-6 py-3 text-left text-xs font-bold text-gray-500 uppercase tracking-wider">Qualification</th><th class="relative px-6 py-3"><span class="sr-only">Actions</span></th></tr></thead><tbody class="divide-y divide-gray-200 bg-white">\x3c!--[--\x3e'),x(n(C),e=>{l('<tr class="hover:bg-blue-50/50 transition-colors cursor-pointer group"><td class="px-6 py-4 whitespace-nowrap"><div class="flex items-center"><div class="flex-shrink-0 h-10 w-10">'),e.photo_url?l(`<img${b("src",e.photo_url)} class="h-10 w-10 rounded-full object-cover border border-gray-200">`):l(`<div class="h-10 w-10 rounded-full bg-[#09033B] text-white flex items-center justify-center font-bold text-sm">${m(e.full_name.charAt(0))}</div>`),l(`</div><div class="ml-4"><div class="text-sm font-bold text-gray-900 group-hover:text-blue-700">${m(e.full_name)}</div><div class="text-xs text-gray-500 bg-gray-100 px-1.5 rounded inline-block mt-0.5 capitalize">${m(e.role)}</div></div></div></td><td class="px-6 py-4 whitespace-nowrap"><div class="text-sm text-gray-900">${m(e.email)}</div><div class="text-xs text-gray-500 mt-0.5">${m(e.phone||"No phone")}</div></td><td class="px-6 py-4 whitespace-nowrap">`),e.qualification?l(`<span class="px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-50 text-blue-700 border border-blue-100">${m(e.qualification)}</span>`):l('<span class="text-gray-400 text-xs italic">--</span>'),l('</td><td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">'),l(f($,{items:getActionItems(e),ui:{width:"w-48"}},{default:d((e,t,r,l)=>{if(!t)return[c("button",{class:"text-gray-400 hover:text-gray-600 p-2 rounded-full hover:bg-gray-100"},[c(y,{name:"i-heroicons-ellipsis-vertical",class:"w-5 h-5"})])];t(`<button class="text-gray-400 hover:text-gray-600 p-2 rounded-full hover:bg-gray-100"${l}>`),t(f(y,{name:"i-heroicons-ellipsis-vertical",class:"w-5 h-5"},null,r,l)),t("</button>")}),_:2},o)),l("</td></tr>")}),l("\x3c!--]--\x3e</tbody></table></div></div>")),n(B)?(l('<div class="relative z-50" aria-labelledby="modal-title" role="dialog" aria-modal="true"><div class="fixed inset-0 bg-gray-900 bg-opacity-50 transition-opacity backdrop-blur-sm"></div><div class="fixed inset-0 z-10 w-screen overflow-y-auto"><div class="flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0"><div class="relative transform overflow-hidden rounded-lg bg-white text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-2xl flex flex-col max-h-[90vh]"><div class="px-6 py-4 border-b border-gray-200 flex justify-between items-center bg-gray-50 sticky top-0 z-10"><h3 class="text-lg font-bold text-gray-900">Edit Staff Profile</h3><button class="text-gray-400 hover:text-gray-600 transition-colors p-1 rounded-full hover:bg-gray-200">'),l(f(y,{name:"i-heroicons-x-mark",class:"w-6 h-6"},null,o)),l('</button></div><div class="p-6 overflow-y-auto"><form id="edit-form" class="space-y-6"><div class="flex flex-col sm:flex-row gap-6"><div class="w-full sm:w-1/3 flex flex-col items-center text-center"><div class="h-24 w-24 rounded-full bg-gray-100 flex items-center justify-center overflow-hidden border-4 border-white shadow-md mb-3">'),n(k).photo_url?l(`<img${b("src",n(k).photo_url)} class="h-full w-full object-cover">`):l(`<span class="text-3xl font-bold text-gray-400">${m(n(k).full_name?.charAt(0))}</span>`),l(`</div><p class="text-[10px] text-gray-500 leading-tight">Profile photos cannot be changed here. Please re-register if a new photo is required.</p></div><div class="w-full sm:w-2/3 space-y-4"><div><label class="block text-xs font-bold text-gray-700 uppercase mb-1">Full Name</label><input${b("value",n(k).full_name)} class="w-full border border-gray-300 p-2 rounded text-sm focus:border-[#09033B] focus:ring-1 focus:ring-[#09033B] outline-none" required></div><div><label class="block text-xs font-bold text-gray-700 uppercase mb-1">Email (Login)</label><input${b("value",n(k).email)} type="email" class="w-full border border-gray-300 p-2 rounded text-sm focus:border-[#09033B] focus:ring-1 focus:ring-[#09033B] outline-none" required></div><div class="grid grid-cols-2 gap-3"><div><label class="block text-xs font-bold text-gray-700 uppercase mb-1">Phone</label><input${b("value",n(k).phone)} class="w-full border border-gray-300 p-2 rounded text-sm focus:border-[#09033B] focus:ring-1 focus:ring-[#09033B] outline-none"></div><div><label class="block text-xs font-bold text-gray-700 uppercase mb-1">Qualification</label><select class="w-full border border-gray-300 p-2 rounded text-sm bg-white outline-none focus:border-[#09033B]"><option${v(Array.isArray(n(k).qualification)?g(n(k).qualification,null):h(n(k).qualification,null))?" selected":""}>NCE</option><option${v(Array.isArray(n(k).qualification)?g(n(k).qualification,null):h(n(k).qualification,null))?" selected":""}>B.Ed</option><option${v(Array.isArray(n(k).qualification)?g(n(k).qualification,null):h(n(k).qualification,null))?" selected":""}>B.Sc</option><option${v(Array.isArray(n(k).qualification)?g(n(k).qualification,null):h(n(k).qualification,null))?" selected":""}>M.Sc</option><option${v(Array.isArray(n(k).qualification)?g(n(k).qualification,null):h(n(k).qualification,null))?" selected":""}>PhD</option><option${v(Array.isArray(n(k).qualification)?g(n(k).qualification,null):h(n(k).qualification,null))?" selected":""}>SSCE</option></select></div></div><div><label class="block text-xs font-bold text-gray-700 uppercase mb-1">Address</label><textarea rows="2" class="w-full border border-gray-300 p-2 rounded text-sm focus:border-[#09033B] focus:ring-1 focus:ring-[#09033B] outline-none">${m(n(k).address)}</textarea></div></div></div><div class="bg-blue-50/50 p-4 rounded-lg border border-blue-100"><h4 class="text-xs font-bold text-[#09033B] uppercase mb-3">Guarantor Details</h4><div class="space-y-3"><div><label class="block text-[10px] font-bold text-gray-500 mb-1">FULL NAME</label><input${b("value",n(k).guarantor_name)} class="w-full border border-gray-300 p-2 rounded text-sm bg-white focus:border-[#09033B] outline-none"></div><div class="grid grid-cols-1 sm:grid-cols-2 gap-3"><div><label class="block text-[10px] font-bold text-gray-500 mb-1">PHONE</label><input${b("value",n(k).guarantor_phone)} class="w-full border border-gray-300 p-2 rounded text-sm bg-white focus:border-[#09033B] outline-none"></div><div><label class="block text-[10px] font-bold text-gray-500 mb-1">RELATIONSHIP</label><input${b("value",n(k).guarantor_rel)} class="w-full border border-gray-300 p-2 rounded text-sm bg-white focus:border-[#09033B] outline-none"></div></div></div></div></form></div><div class="px-6 py-4 border-t border-gray-200 bg-gray-50 flex justify-between items-center sticky bottom-0 z-10"><button type="button" class="text-red-600 hover:bg-red-50 px-3 py-2 rounded text-xs font-bold flex items-center gap-1 transition-colors">`),l(f(y,{name:"i-heroicons-trash",class:"w-4 h-4"},null,o)),l(` Delete Account </button><div class="flex gap-3"><button class="px-4 py-2 text-gray-600 hover:text-gray-900 font-medium text-sm transition-colors border border-gray-300 rounded hover:bg-white">Cancel</button><button type="submit" form="edit-form"${v(n(_))?" disabled":""} class="bg-[#09033B] text-white px-6 py-2 rounded shadow hover:bg-opacity-90 font-bold text-sm transition-colors flex items-center gap-2">`),n(_)?l('<span class="animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent"></span>'):l("\x3c!----\x3e"),l(` ${m(n(_)?"Saving...":"Save Changes")}</button></div></div></div></div></div></div>`)):l("\x3c!----\x3e"),l("</div>")}}}),q=$.setup;$.setup=(e,t)=>{const r=u();return(r.modules||(r.modules=new Set)).add("pages/admin/staff/index.vue"),q?q(e,t):void 0};export{$ as default};
//# sourceMappingURL=index-Dc65RLSI.mjs.map
