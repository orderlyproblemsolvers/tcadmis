import{computed as e,toValue as t,reactive as s}from"vue";import{L as a}from"../_/nitro.mjs";import{isPlainObject as o}from"@vue/shared";import{h as r,i as n}from"./server.mjs";import{u as i}from"./asyncData-DWeUa_vf.mjs";function useFetch(o,c,f){const[u={},h]="string"==typeof c?[{},c]:[c,f],m=e(()=>t(o)),p=e(()=>t(u.key)||"$f"+a([h,"string"==typeof m.value?m.value:"",...generateOptionSegments(u)]));if(!u.baseURL&&"string"==typeof m.value&&"/"===m.value[0]&&"/"===m.value[1])throw new Error('[nuxt] [useFetch] the request URL must not start with "//".');const{server:l,lazy:d,default:v,transform:y,pick:g,watch:b,immediate:U,getCachedData:w,deep:F,dedupe:L,timeout:j,...D}=u,R=s({...r,...D,cache:"boolean"==typeof u.cache?void 0:u.cache}),O={server:l,lazy:d,default:v,transform:y,pick:g,immediate:U,getCachedData:w,deep:F,dedupe:L,timeout:j,watch:!1===b?[]:[...b||[],R]};return i(!1===b?p.value:p,(e,{signal:s})=>{let a=u.$fetch||globalThis.$fetch;if(!u.$fetch){"string"==typeof m.value&&"/"===m.value[0]&&(!t(u.baseURL)||"/"===t(u.baseURL)[0])&&(a=n())}return a(m.value,{signal:s,...R})},O)}function generateOptionSegments(e){const r=[t(e.method)?.toUpperCase()||"GET",t(e.baseURL)];for(const s of[e.query||e.params]){const e=t(s);if(!e)continue;const a={};for(const[s,o]of Object.entries(e))a[t(s)]=t(o);r.push(a)}if(e.body){const n=t(e.body);if(n)if(n instanceof ArrayBuffer)r.push(a(Object.fromEntries([...new Uint8Array(n).entries()].map(([e,t])=>[e,t.toString()]))));else if(n instanceof FormData){const e={};for(const t of n.entries()){const[s,a]=t;e[s]=a instanceof File?a.name:a}r.push(a(e))}else if(o(n))r.push(a(s(n)));else try{r.push(a(n))}catch{console.warn("[useFetch] Failed to hash body",n)}else r.push(a(n))}return r}export{useFetch as u};
//# sourceMappingURL=fetch-Cnghzd6E.mjs.map
